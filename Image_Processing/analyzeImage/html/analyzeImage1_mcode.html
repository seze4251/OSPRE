<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%% Anthony Torres</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% OSPRE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% analyzeImage.m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Created: 1/13/17</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Modified: 1/13/17</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">function</span>[<span class="var type1" id="S2T1U3">centerPt</span>, <span class="var type1" id="S3T2U4">radius</span>, <span class="var type1" id="S4T2U5">numCirc</span>] = analyzeImage(<span class="var type1" id="S5T3U8">imIn</span>, <span class="var type1" id="S6T4U9">radiusRangeGuess</span>, <span class="var type1" id="S7T2U10">sensVal</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%% Preprocessing section</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T5:U7"><span class="var type1" id="S8T5U13">im</span> = <span class="mxinfo " id="T5:U9">rgb2gray(<span class="var type1" id="S5T3U16">imIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="comment">% Convert to BW, hreshold, and fill image</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T6:U11"><span class="var type1" id="S10T6U19">bw</span> = <span class="mxinfo " id="T6:U13">imfill(<span class="mxinfo " id="T6:U14">imbinarize(<span class="var type1" id="S8T5U24">im</span>)</span>,<span class="string">'holes'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="comment">%% Analyze image to find center point and radius</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="comment">% Find circle fit through CHT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">[<span class="var type1" id="S13T7U29">centers</span>, <span class="var type1" id="S14T7U30">radii</span>] = imfindcircles(<span class="var type1" id="S10T6U33">bw</span>, <span class="var type1" id="S6T4U34">radiusRangeGuess</span>, <span class="string">'Sensitivity'</span>, <span class="var type1" id="S7T2U36">sensVal</span>, <span class="string">'ObjectPolarity'</span>, <span class="string">'bright'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="comment">%% Check for valid find</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="keyword">if</span>(isempty(<span class="var type1" id="S13T7U44">centers</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="comment">%warning('No centers!')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T1:U22"><span class="var type1" id="S2T1U47">centerPt</span> = <span class="mxinfo " id="T2:U24">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T2:U25"><span class="var type1" id="S3T2U52">radius</span> = <span class="mxinfo " id="T2:U27">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T2:U28"><span class="var type1" id="S4T2U57">numCirc</span> = <span class="mxinfo " id="T2:U30">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="comment">%% Return found information</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T1:U31"><span class="var type1" id="S2T1U63">centerPt</span> = <span class="mxinfo " id="T4:U33">[<span class="mxinfo " id="T2:U34"><span class="var type1" id="S13T7U67">centers</span>(<span class="mxinfo " id="T2:U36">1</span>)</span> <span class="mxinfo " id="T2:U37"><span class="var type1" id="S13T7U70">centers</span>(<span class="mxinfo " id="T2:U39">2</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T2:U40"><span class="var type1" id="S3T2U74">radius</span> = <span class="mxinfo " id="T2:U42"><span class="var type1" id="S14T7U76">radii</span>(<span class="mxinfo " id="T2:U44">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo " id="T2:U45"><span class="var type1" id="S4T2U80">numCirc</span> = <span class="mxinfo " id="T2:U47">length(<span class="var type1" id="S14T7U83">radii</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
